@{
    Layout = null;
    var shop = ViewBag.Shop as BerberOto.Models.Shop;
    var todayAppointments = ViewBag.TodayAppointments as List<BerberOto.Models.Appointment>;
    var pendingCount = (int)ViewBag.PendingCount;
    var totalAppointments = (int)ViewBag.TotalAppointments;
}

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - @shop?.Name</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="stylesheet" href="/css/admin.css" />
</head>
<body>
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                @shop?.Name.Substring(0, Math.Min(2, shop.Name.Length)).ToUpper()
            </div>
            <h2 class="sidebar-title">@shop?.Name</h2>
            <span class="sidebar-badge">Admin Panel</span>
        </div>
        <nav class="sidebar-nav">
            <a href="/salon/@shop?.Slug/admin/dashboard" class="nav-item active">
                <i class="fa-solid fa-gauge-high"></i> Dashboard
            </a>
            <a href="/salon/@shop?.Slug/admin/randevular" class="nav-item">
                <i class="fa-solid fa-calendar-days"></i> Randevular
                @if (pendingCount > 0)
                {
                    <span class="badge">@pendingCount</span>
                }
            </a>
            <a href="/salon/@shop?.Slug/admin/berberler" class="nav-item">
                <i class="fa-solid fa-user-group"></i> Berberler
            </a>
            <a href="/salon/@shop?.Slug/admin/hizmetler" class="nav-item">
                <i class="fa-solid fa-scissors"></i> Hizmetler
            </a>
            <a href="/salon/@shop?.Slug/admin/calisma-saatleri" class="nav-item">
                <i class="fa-solid fa-clock"></i> Çalışma Saatleri
            </a>
        </nav>
        <div class="sidebar-footer">
            <a href="/salon/@shop?.Slug" class="nav-item">
                <i class="fa-solid fa-store"></i> Dükkana Git
            </a>
            <a href="/salon/@shop?.Slug/admin/cikis" class="nav-item logout">
                <i class="fa-solid fa-right-from-bracket"></i> Çıkış
            </a>
        </div>
    </aside>

    <!-- MAIN -->
    <main class="main-content">
        <div class="page-header">
            <h1>Dashboard</h1>
            <p>Hoş geldin, <strong>@shop?.OwnerName</strong>!</p>
        </div>

        <!-- STAT CARDS -->
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(79,172,254,0.15); color: #4facfe;">
                    <i class="fa-solid fa-calendar-check"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-number">@totalAppointments</span>
                    <span class="stat-label">Toplam Randevu</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(255,183,77,0.15); color: #FFB74D;">
                    <i class="fa-solid fa-clock"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-number">@pendingCount</span>
                    <span class="stat-label">Bekleyen</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(129,199,132,0.15); color: #81C784;">
                    <i class="fa-solid fa-user-group"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-number">@shop?.Barbers.Count</span>
                    <span class="stat-label">Berber</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(212,165,116,0.15); color: #D4A574;">
                    <i class="fa-solid fa-star"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-number">@shop?.Reviews.Count</span>
                    <span class="stat-label">Yorum</span>
                </div>
            </div>
        </div>

        <!-- TODAY'S APPOINTMENTS -->
        <div class="panel">
            <div class="panel-header">
                <h2><i class="fa-solid fa-calendar-day"></i> Bugünün Randevuları</h2>
                <span class="panel-date">@DateTime.Now.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR"))</span>
            </div>
            @if (todayAppointments != null && todayAppointments.Any())
            {
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Saat</th>
                                <th>Müşteri</th>
                                <th>Berber</th>
                                <th>Hizmet</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var a in todayAppointments)
                            {
                                <tr>
                                    <td><strong>@a.AppointmentTime</strong></td>
                                    <td>@a.CustomerName</td>
                                    <td>@a.Barber?.FullName</td>
                                    <td>@a.Service?.Name</td>
                                    <td>
                                        @if (a.Status == BerberOto.Models.AppointmentStatus.Pending)
                                        {
                                            <span class="status-badge pending">Bekliyor</span>
                                        }
                                        else if (a.Status == BerberOto.Models.AppointmentStatus.Confirmed)
                                        {
                                            <span class="status-badge confirmed">Onaylı</span>
                                        }
                                        else
                                        {
                                            <span class="status-badge cancelled">İptal</span>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <div class="empty-state">
                    <i class="fa-regular fa-calendar-xmark"></i>
                    <p>Bugün için randevu yok</p>
                </div>
            }
        </div>
    </main>
</body>
</html>
